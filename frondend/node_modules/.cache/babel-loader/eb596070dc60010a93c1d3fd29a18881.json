{"ast":null,"code":"import _toConsumableArray from\"/Users/galina/dev/react-mesto-auth/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/galina/dev/react-mesto-auth/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import Header from\"./Header.jsx\";import Footer from\"./Footer.jsx\";import Main from\"./Main.jsx\";import PopupWithForm from\"./PopupWithForm.jsx\";import EditProfilePopup from\"./EditProfilePopup.jsx\";import EditAvatarPopup from\"./EditAvatarPopup.jsx\";import AddPlacePopup from\"./AddPlacePopup.jsx\";import ImagePopup from\"./ImagePopup.jsx\";import{api}from\"../utils/api\";import{CurrentUserContext}from\"../contexts/CurrentUserContext.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isEditProfilePopupOpen=_useState2[0],setIsEditProfilePopupOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAddPlacePopupOpen=_useState4[0],setIsAddPlacePopupOpen=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEditAvatarPopupOpen=_useState6[0],setIsEditAvatarPopupOpen=_useState6[1];var _useState7=useState({name:\"\",link:\"\"}),_useState8=_slicedToArray(_useState7,2),selectedCard=_useState8[0],setSelectedCard=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),currentUser=_useState10[0],setCurrentUser=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),cards=_useState12[0],setCards=_useState12[1];useEffect(function(){Promise.all([api.getProfile(),api.getInitialCards()]).then(function(_ref){var _ref2=_slicedToArray(_ref,2),useData=_ref2[0],card=_ref2[1];setCurrentUser(useData);setCards(card);}).catch(function(err){console.log(\"Error: \",err);});},[]);function handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);}function handleEditProfileClick(){setIsEditProfilePopupOpen(true);}function handleAddPlaceClick(){setIsAddPlacePopupOpen(true);}function handleCardClick(card){setSelectedCard(card);}function closeAllPopups(){setIsEditAvatarPopupOpen(false);setIsEditProfilePopupOpen(false);setIsAddPlacePopupOpen(false);setSelectedCard({name:\"\",link:\"\"});}function handleUpdateUser(data){api.editProfile(data).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){console.log(\"Error: \",err);});}function handleUpdateAvatar(avatar){api.editAvatarProfile(avatar).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){console.log(\"Error: \",err);});}function handleCardLike(card){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=card.likes.some(function(user){return user._id===currentUser._id;});// Отправляем запрос в API и получаем обновлённые данные карточки\nvar request=isLiked?api.deleteLike(card._id):api.addLike(card._id);request.then(function(newCard){setCards(function(state){return state.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(res){console.log(res);});}function handleCardDelete(card){api.deleteCard(card._id).then(function(){setCards(function(state){return state.filter(function(item){return item._id!==card._id;});});}).catch(function(res){console.log(res);});}function handleAddPlaceSubmit(item){api.addNewCard(item).then(function(newCard){setCards([newCard].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){console.log(\"Error: \",err);});}return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsxs(\"div\",{className:\"page\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{onCardClick:handleCardClick,onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick,cards:cards,onCardLike:handleCardLike,onCardDelete:handleCardDelete}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(ImagePopup,{onClose:closeAllPopups,card:selectedCard}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(PopupWithForm,{onClose:closeAllPopups,name:\"delete-photo\",title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",buttonText:\"\\u0414a\"}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(AddPlacePopup,{onClose:closeAllPopups,isOpen:isAddPlacePopupOpen,onAddPlace:handleAddPlaceSubmit})]})});}export default App;","map":{"version":3,"names":["useState","useEffect","Header","Footer","Main","PopupWithForm","EditProfilePopup","EditAvatarPopup","AddPlacePopup","ImagePopup","api","CurrentUserContext","App","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","name","link","selectedCard","setSelectedCard","currentUser","setCurrentUser","cards","setCards","Promise","all","getProfile","getInitialCards","then","useData","card","catch","err","console","log","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","handleCardClick","closeAllPopups","handleUpdateUser","data","editProfile","res","handleUpdateAvatar","avatar","editAvatarProfile","handleCardLike","isLiked","likes","some","user","_id","request","deleteLike","addLike","newCard","state","map","c","handleCardDelete","deleteCard","filter","item","handleAddPlaceSubmit","addNewCard"],"sources":["/Users/galina/dev/react-mesto-auth/src/components/App.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport Header from \"./Header.jsx\";\nimport Footer from \"./Footer.jsx\";\nimport Main from \"./Main.jsx\";\nimport PopupWithForm from \"./PopupWithForm.jsx\";\nimport EditProfilePopup from \"./EditProfilePopup.jsx\";\nimport EditAvatarPopup from \"./EditAvatarPopup.jsx\";\nimport AddPlacePopup from \"./AddPlacePopup.jsx\";\nimport ImagePopup from \"./ImagePopup.jsx\";\nimport { api } from \"../utils/api\";\nimport { CurrentUserContext } from \"../contexts/CurrentUserContext.js\";\n\nfunction App() {\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = useState(false);\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = useState(false);\n  const [selectedCard, setSelectedCard] = useState({ name: \"\", link: \"\" });\n  const [currentUser, setCurrentUser] = useState({});\n  const [cards, setCards] = useState([]);\n\n  useEffect(() => {\n    Promise.all([api.getProfile(), api.getInitialCards()])\n      .then(([useData, card]) => {\n        setCurrentUser(useData);\n        setCards(card);\n      })\n      .catch((err) => {\n        console.log(\"Error: \", err);\n      });\n  }, []);\n\n  function handleEditAvatarClick() {\n    setIsEditAvatarPopupOpen(true);\n  }\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n  function handleAddPlaceClick() {\n    setIsAddPlacePopupOpen(true);\n  }\n  function handleCardClick(card) {\n    setSelectedCard(card);\n  }\n\n  function closeAllPopups() {\n    setIsEditAvatarPopupOpen(false);\n    setIsEditProfilePopupOpen(false);\n    setIsAddPlacePopupOpen(false);\n    setSelectedCard({ name: \"\", link: \"\" });\n  }\n\n  function handleUpdateUser(data) {\n    api\n      .editProfile(data)\n      .then((res) => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(\"Error: \", err);\n      });\n  }\n\n  function handleUpdateAvatar(avatar) {\n    api\n      .editAvatarProfile(avatar)\n      .then((res) => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(\"Error: \", err);\n      });\n  }\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some((user) => user._id === currentUser._id);\n\n    // Отправляем запрос в API и получаем обновлённые данные карточки\n    const request = isLiked ? api.deleteLike(card._id) : api.addLike(card._id);\n    request\n      .then((newCard) => {\n        setCards((state) =>\n          state.map((c) => (c._id === card._id ? newCard : c))\n        );\n      })\n      .catch((res) => {\n        console.log(res);\n      });\n  }\n\n  function handleCardDelete(card) {\n    api\n      .deleteCard(card._id)\n      .then(() => {\n        setCards((state) => state.filter((item) => item._id !== card._id));\n      })\n      .catch((res) => {\n        console.log(res);\n      });\n  }\n\n  function handleAddPlaceSubmit(item) {\n    api\n      .addNewCard(item)\n      .then((newCard) => {\n        setCards([newCard, ...cards]);\n        closeAllPopups();\n      })\n      .catch((err) => {\n        console.log(\"Error: \", err);\n      });\n  }\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className=\"page\">\n        <Header />\n\n        <Main\n          onCardClick={handleCardClick}\n          onEditProfile={handleEditProfileClick}\n          onAddPlace={handleAddPlaceClick}\n          onEditAvatar={handleEditAvatarClick}\n          cards={cards}\n          onCardLike={handleCardLike}\n          onCardDelete={handleCardDelete}\n        />\n\n        <Footer />\n\n        {/* <!-- popup просмотра фото--> */}\n        <ImagePopup onClose={closeAllPopups} card={selectedCard} />\n\n        {/* popup редактирования профиля */}\n        <EditProfilePopup\n          isOpen={isEditProfilePopupOpen}\n          onClose={closeAllPopups}\n          onUpdateUser={handleUpdateUser}\n        />\n\n        {/* popup удаление карточки */}\n        <PopupWithForm\n          onClose={closeAllPopups}\n          name=\"delete-photo\"\n          title=\"Вы уверены?\"\n          buttonText=\"Дa\"\n        ></PopupWithForm>\n\n        {/* popup редактирования аватара */}\n        <EditAvatarPopup\n          isOpen={isEditAvatarPopupOpen}\n          onClose={closeAllPopups}\n          onUpdateAvatar={handleUpdateAvatar}\n        />\n\n        {/* popup форма добавления фото */}\n        <AddPlacePopup\n          onClose={closeAllPopups}\n          isOpen={isAddPlacePopupOpen}\n          onAddPlace={handleAddPlaceSubmit}\n        />\n      </div>\n    </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}